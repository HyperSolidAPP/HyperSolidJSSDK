<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>HyperSolid WebView SDK Testing</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
      }

      .header {
        background: white;
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        color: #333;
        font-size: 28px;
        margin-bottom: 10px;
      }

      .sdk-status {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 15px;
      }

      .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: #ff4444;
        animation: pulse 2s infinite;
      }

      .status-indicator.ready {
        background: #00c851;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }

      .status-text {
        color: #666;
        font-size: 14px;
      }

      .version-info {
        color: #999;
        font-size: 12px;
        margin-top: 5px;
      }

      .test-section {
        background: white;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      }

      .test-section h2 {
        color: #333;
        font-size: 20px;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f0f0f0;
      }

      .test-group {
        margin-bottom: 15px;
      }

      .test-group h3 {
        color: #666;
        font-size: 16px;
        margin-bottom: 10px;
      }

      .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 120px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      button:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
      }

      .result-panel {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 15px;
        margin-top: 15px;
        min-height: 100px;
        max-height: 400px;
        overflow-y: auto;
      }

      .result-panel pre {
        white-space: pre-wrap;
        word-wrap: break-word;
        color: #333;
        font-size: 12px;
        font-family: "Courier New", monospace;
      }

      .log-entry {
        padding: 8px;
        margin-bottom: 5px;
        border-radius: 4px;
        font-size: 13px;
      }

      .log-entry.success {
        background: #e8f5e9;
        color: #2e7d32;
      }

      .log-entry.error {
        background: #ffebee;
        color: #c62828;
      }

      .log-entry.info {
        background: #e3f2fd;
        color: #1565c0;
      }

      .input-group {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }

      input[type="text"],
      select {
        flex: 1;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
      }

      input[type="text"]:focus,
      select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .clear-btn {
        background: #ff4444;
        position: fixed;
        bottom: 20px;
        right: 20px;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        box-shadow: 0 5px 20px rgba(255, 68, 68, 0.3);
      }

      .loading {
        display: inline-block;
        width: 14px;
        height: 14px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header Status -->
      <div class="header">
        <h1>üöÄ HyperSolid WebView SDK Testing</h1>
        <div class="sdk-status">
          <div class="status-indicator" id="statusIndicator"></div>
          <span class="status-text" id="statusText">SDK Initializing...</span>
        </div>
        <div class="version-info" id="versionInfo">Version: Detecting...</div>
      </div>

      <!-- Wallet API Testing -->
      <div class="test-section">
        <h2>üí∞ Wallet API</h2>
        <div class="test-group">
          <div class="button-group">
            <button onclick="testGetWalletInfo()">Get Wallet Info</button>
            <button onclick="testGetWalletAddress()">Get Wallet Address</button>
            <button onclick="testGetWalletPerpBalance()">Get Balance</button>
            <button onclick="testIsWalletConnected()">
              Check Connection Status
            </button>
          </div>
        </div>
        <div class="result-panel">
          <pre id="walletResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Position API Testing -->
      <div class="test-section">
        <h2>üìä Position API</h2>
        <div class="test-group">
          <h3>Position Query</h3>
          <div class="button-group">
            <button onclick="testGetPositions()">Get All Positions</button>
            <button onclick="testGetPositionSummary()">
              Get Position Summary
            </button>
            <button onclick="testGetLongPositions()">Get Long Positions</button>
            <button onclick="testGetShortPositions()">
              Get Short Positions
            </button>
          </div>
        </div>
        <div class="test-group">
          <h3>Single Position Query</h3>
          <div class="input-group">
            <input
              type="text"
              id="positionCoin"
              placeholder="Coin symbol (e.g. BTC, ETH, SOL)"
              value="BTC"
            />
          </div>
          <div class="button-group">
            <button onclick="testGetPosition()">Get Position</button>
            <button onclick="testHasPosition()">Check Position</button>
          </div>
        </div>
        <div class="result-panel">
          <pre id="positionResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Order API Testing -->
      <div class="test-section">
        <h2>üìù Order API</h2>
        <div class="test-group">
          <h3>Order Query</h3>
          <div class="button-group">
            <button onclick="testGetOpenOrders()">Get All Open Orders</button>
            <button onclick="testGetOrdersSummary()">
              Get Order Statistics
            </button>
            <button onclick="testGetBuyOrders()">Get Buy Orders</button>
            <button onclick="testGetSellOrders()">Get Sell Orders</button>
          </div>
        </div>
        <div class="test-group">
          <h3>Single Coin Order Query</h3>
          <div class="input-group">
            <input
              type="text"
              id="orderCoin"
              placeholder="Coin symbol (e.g. BTC, ETH, SOL)"
              value="BTC"
            />
          </div>
          <div class="button-group">
            <button onclick="testGetOpenOrdersByCoin()">Get Coin Orders</button>
          </div>
        </div>
        <div class="result-panel">
          <pre id="orderResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Fill History API Testing -->
      <div class="test-section">
        <h2>üìà Fill History API</h2>
        <div class="test-group">
          <h3>Fill History Query</h3>
          <div class="button-group">
            <button onclick="testGetUserFills()">Get All Fill History</button>
            <button onclick="testGetFillsSummary()">Get Fill Summary</button>
          </div>
        </div>
        <div class="test-group">
          <h3>Single Coin Fill History Query</h3>
          <div class="input-group">
            <input
              type="text"
              id="fillCoin"
              placeholder="Coin symbol (e.g. BTC, ETH, SOL)"
              value="BTC"
            />
          </div>
          <div class="button-group">
            <button onclick="testGetUserFillsByCoin()">
              Get Coin Fill History
            </button>
          </div>
        </div>
        <div class="result-panel">
          <pre id="fillResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Price Query API Testing -->
      <div class="test-section">
        <h2>üíπ Price Query API</h2>
        <div class="test-group">
          <h3>Price Query</h3>
          <div style="display: flex; flex-direction: column; gap: 10px">
            <input
              type="text"
              id="priceSymbol"
              placeholder="Trading pair symbol (e.g. BTC)"
              value="BTC"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            />
            <select
              id="priceType"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            >
              <option value="perp">Perpetual Contract</option>
              <option value="spot">Spot</option>
            </select>
          </div>
          <div class="button-group" style="margin-top: 10px">
            <button onclick="testGetCurrentPrice()">Get Current Price</button>
            <button onclick="testGetTradeDetail()">Get Trade Details</button>
          </div>
        </div>
        <div class="result-panel">
          <pre id="priceResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Trading API Testing -->
      <div class="test-section">
        <h2>üìà Trading API</h2>
        <div class="test-group">
          <h3>General Parameters</h3>
          <div style="display: flex; flex-direction: column; gap: 10px">
            <input
              type="text"
              id="orderSymbol"
              placeholder="Trading pair symbol (e.g. BTC)"
              value="BTC"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            />
            <input
              type="number"
              id="orderSize"
              placeholder="Quantity"
              value="0.001"
              step="0.0001"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            />
            <div style="display: flex; gap: 20px; margin-top: 5px">
              <label style="display: flex; align-items: center; gap: 5px">
                <input type="checkbox" id="orderIsSpot" />
                <span>Spot Trading</span>
              </label>
              <label style="display: flex; align-items: center; gap: 5px">
                <input type="checkbox" id="orderReduceOnly" />
                <span>Reduce Only</span>
              </label>
            </div>
          </div>
        </div>
        <div class="test-group">
          <h3>Limit Orders (Price Required)</h3>
          <div style="display: flex; flex-direction: column; gap: 10px">
            <input
              type="number"
              id="orderPrice"
              placeholder="Limit order price"
              value="50000"
              step="0.01"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            />
            <div class="button-group">
              <button
                onclick="testLimitBuy()"
                style="background-color: #28a745"
              >
                Limit Buy (Long)
              </button>
              <button
                onclick="testLimitSell()"
                style="background-color: #dc3545"
              >
                Limit Sell (Short)
              </button>
            </div>
          </div>
        </div>
        <div class="test-group">
          <h3>Market Orders (Auto Price)</h3>
          <div class="button-group">
            <button onclick="testMarketBuy()" style="background-color: #17a2b8">
              Market Buy (Long)
            </button>
            <button
              onclick="testMarketSell()"
              style="background-color: #fd7e14"
            >
              Market Sell (Short)
            </button>
          </div>
          <div
            style="
              margin-top: 10px;
              padding: 10px;
              background-color: #f0f0f0;
              border-radius: 4px;
              font-size: 12px;
              color: #666;
            "
          >
            üí° Tip: Market orders automatically get current price from server,
            no manual input needed
          </div>
        </div>
        <div class="test-group">
          <h3>Percentage Orders</h3>
          <div style="display: flex; flex-direction: column; gap: 10px">
            <input
              type="text"
              id="percentOrderSymbol"
              placeholder="Trading pair (e.g. BTC, ETH)"
              value="BTC"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            />
            <input
              type="number"
              id="percentOrderPrice"
              placeholder="Limit order price (not needed for market orders)"
              value="50000"
              step="0.01"
              style="
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
              "
            />
            <div style="display: flex; gap: 10px; align-items: center">
              <input
                type="range"
                id="percentageSlider"
                min="0"
                max="100"
                value="25"
                step="1"
                style="flex: 1"
                oninput="updatePercentageDisplay()"
              />
              <input
                type="number"
                id="percentageInput"
                min="0"
                max="100"
                value="25"
                step="1"
                style="
                  width: 80px;
                  padding: 8px;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                "
                oninput="updatePercentageSlider()"
              />
              <span>%</span>
            </div>
            <div style="display: flex; gap: 20px">
              <label style="display: flex; align-items: center; gap: 5px">
                <input type="checkbox" id="percentOrderIsSpot" />
                <span>Spot Trading</span>
              </label>
              <label style="display: flex; align-items: center; gap: 5px">
                <input type="checkbox" id="percentOrderReduceOnly" />
                <span>Reduce Only</span>
              </label>
            </div>
            <div class="button-group">
              <button
                onclick="testLimitBuyByPercentage()"
                style="background-color: #28a745"
              >
                Limit Buy %
              </button>
              <button
                onclick="testLimitSellByPercentage()"
                style="background-color: #dc3545"
              >
                Limit Sell %
              </button>
              <button
                onclick="testMarketBuyByPercentage()"
                style="background-color: #17a2b8"
              >
                Market Buy %
              </button>
              <button
                onclick="testMarketSellByPercentage()"
                style="background-color: #fd7e14"
              >
                Market Sell %
              </button>
            </div>
            <div
              style="
                margin-top: 10px;
                padding: 10px;
                background-color: #e7f3ff;
                border-radius: 4px;
                font-size: 12px;
                color: #0066cc;
              "
            >
              üìä Note: Percentage orders automatically get your maximum tradable
              amount and calculate actual order size by specified percentage
            </div>
          </div>
        </div>
        <div class="result-panel">
          <pre id="tradingResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- User Asset Information API Testing -->
      <div class="test-section">
        <h2>üí∞ User Asset Information API</h2>

        <!-- User Asset Data Query -->
        <div class="test-group">
          <h3>User Asset Data Query</h3>
          <div class="input-group">
            <input
              type="text"
              id="assetSymbol"
              placeholder="Coin symbol (e.g. BTC, ETH)"
              value="BTC"
              style="width: 100%; padding: 8px"
            />
          </div>
          <div class="button-group">
            <button onclick="testGetUserActiveAssetData()">
              Get User Asset Data
            </button>
            <button onclick="testGetUserMaxTradeSizes()">
              Get User Trade Volume
            </button>
          </div>
        </div>

        <div class="result-panel">
          <pre id="assetResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Navigation API Testing -->
      <div class="test-section">
        <h2>üß≠ Navigation API</h2>

        <!-- Basic Navigation -->
        <div class="test-group">
          <h3>Basic Navigation</h3>
          <div class="button-group">
            <button onclick="testNavigateHome()">Go to Home</button>
            <button onclick="testNavigatePortfolio()">Portfolio</button>
            <button onclick="testNavigateTrade()">Trade Page</button>
            <button onclick="testNavigateAccount()">Account Page</button>
            <button onclick="testGoBack()">Go Back</button>
            <button onclick="testCanGoBack()">Check Can Go Back</button>
            <button onclick="testGetCurrentRoute()">Current Route</button>
          </div>
        </div>

        <!-- Trade Navigation -->
        <div class="test-group">
          <h3>Trade Navigation</h3>
          <div class="input-group">
            <input
              type="text"
              id="tradeSymbol"
              placeholder="Trading pair (e.g. BTC)"
              value="BTC"
            />
            <select id="tradeType">
              <option value="spot">Spot</option>
              <option value="perp">Perpetual Contract</option>
            </select>
          </div>
          <div class="button-group">
            <button onclick="testNavigateTradeDetail()">Trade Page</button>
            <button onclick="testNavigateTradeOrder()">Order Page</button>
          </div>
        </div>

        <!-- Custom Navigation -->
        <div class="test-group">
          <h3>Custom Navigation</h3>
          <div class="input-group">
            <input
              type="text"
              id="customRoute"
              placeholder="Route path (e.g. /home)"
              value="/home"
            />
          </div>
          <div class="button-group">
            <button onclick="testNavigateCustom()">Go to Custom Route</button>
          </div>
        </div>

        <div class="result-panel">
          <pre id="navigationResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- System API Testing -->
      <div class="test-section">
        <h2>‚öôÔ∏è System API</h2>
        <div class="test-group">
          <div class="button-group">
            <button onclick="testRefresh()">Refresh Page</button>
            <button onclick="testGetVersion()">Get Version</button>
            <button onclick="testPing()">Ping Flutter</button>
            <button onclick="testGetSystemInfo()">System Info</button>
          </div>
        </div>
        <div class="result-panel">
          <pre id="systemResult">Waiting for test...</pre>
        </div>
      </div>

      <!-- Log Output -->
      <div class="test-section">
        <h2>üìã Log Output</h2>
        <div class="result-panel" style="min-height: 200px">
          <div id="logOutput"></div>
        </div>
      </div>
    </div>

    <!-- Clear Log Button -->
    <button class="clear-btn" onclick="clearLogs()">üóëÔ∏è</button>

    <!-- Include SDK -->
    <script src="./jssdk/hypersolid-sdk.js"></script>

    <!-- Test Scripts -->
    <script>
      // Log Management
      let logEntries = [];

      function addLog(message, type = "info") {
        const logOutput = document.getElementById("logOutput");
        const entry = document.createElement("div");
        entry.className = `log-entry ${type}`;
        const timestamp = new Date().toLocaleTimeString();
        entry.textContent = `[${timestamp}] ${message}`;
        logOutput.appendChild(entry);
        logOutput.scrollTop = logOutput.scrollHeight;

        // Save log
        logEntries.push({ message, type, timestamp });
      }

      function clearLogs() {
        document.getElementById("logOutput").innerHTML = "";
        logEntries = [];
        addLog("Logs cleared", "info");
      }

      function updateResult(panelId, content, isError = false) {
        const panel = document.getElementById(panelId);
        if (panel) {
          if (typeof content === "object") {
            panel.textContent = JSON.stringify(content, null, 2);
          } else {
            panel.textContent = content;
          }
          panel.style.color = isError ? "#c62828" : "#333";
        }
      }

      // SDK Initialization Check
      function checkSDKStatus() {
        if (window.HyperSolidSDK && window.HyperSolidSDK.utils.isReady()) {
          document.getElementById("statusIndicator").classList.add("ready");
          document.getElementById("statusText").textContent = "SDK Ready";
          document.getElementById(
            "versionInfo"
          ).textContent = `Version: ${window.HyperSolidSDK.version}`;
          addLog("HyperSolid SDK initialized successfully", "success");
          return true;
        }
        return false;
      }

      // Wallet API Tests
      async function testGetWalletInfo() {
        try {
          addLog("Calling wallet.getInfo()...", "info");
          const { data: info } = await window.HyperSolidSDK.wallet.getInfo();
          updateResult("walletResult", info);
          addLog("Get wallet info successful", "success");
        } catch (error) {
          updateResult("walletResult", `Error: ${error.message}`, true);
          addLog(`Get wallet info failed: ${error.message}`, "error");
        }
      }

      async function testGetWalletAddress() {
        try {
          addLog("Calling wallet.getAddress()...", "info");
          const { data: result } =
            await window.HyperSolidSDK.wallet.getAddress();
          updateResult(
            "walletResult",
            `Wallet address: ${JSON.stringify(result.address)}`
          );
          addLog(`Get wallet address successful: ${result.address}`, "success");
        } catch (error) {
          updateResult("walletResult", `Error: ${error.message}`, true);
          addLog(`Get wallet address failed: ${error.message}`, "error");
        }
      }

      async function testGetWalletPerpBalance() {
        try {
          addLog("Calling wallet.getWalletPerpBalance()...", "info");
          const { data: perpBalance } =
            await window.HyperSolidSDK.wallet.getWalletPerpBalance();
          updateResult("walletResult", perpBalance);
          addLog("Get balance successful", "success");
        } catch (error) {
          updateResult("walletResult", `Error: ${error.message}`, true);
          addLog(`Get balance failed: ${error.message}`, "error");
        }
      }

      async function testIsWalletConnected() {
        try {
          addLog("Calling wallet.isConnected()...", "info");
          const { data: isConnected } =
            await window.HyperSolidSDK.wallet.isConnected();
          updateResult(
            "walletResult",
            `Connection status: ${isConnected ? "Connected" : "Disconnected"}`
          );
          addLog(
            `Wallet connection status: ${
              isConnected ? "Connected" : "Disconnected"
            }`,
            "success"
          );
        } catch (error) {
          updateResult("walletResult", `Error: ${error.message}`, true);
          addLog(`Check connection status failed: ${error.message}`, "error");
        }
      }

      // Position API Tests
      async function testGetPositions() {
        try {
          addLog("Calling position.getPositions()...", "info");
          const { data: positions } =
            await window.HyperSolidSDK.position.getPositions();
          updateResult("positionResult", positions);
          addLog(`Got ${positions.length} positions`, "success");
        } catch (error) {
          updateResult("positionResult", `Error: ${error.message}`, true);
          addLog(`Get position list failed: ${error.message}`, "error");
        }
      }

      async function testGetPosition() {
        try {
          const coin = document.getElementById("positionCoin").value;
          addLog(`Calling position.getPosition('${coin}')...`, "info");
          const { data: position } =
            await window.HyperSolidSDK.position.getPosition(coin);
          if (position) {
            updateResult("positionResult", position);
            addLog(`Get ${coin} position successful`, "success");
          } else {
            updateResult("positionResult", `No ${coin} position found`);
            addLog(`No ${coin} position found`, "info");
          }
        } catch (error) {
          updateResult("positionResult", `Error: ${error.message}`, true);
          addLog(`Get position failed: ${error.message}`, "error");
        }
      }

      async function testGetPositionSummary() {
        try {
          addLog("Calling position.getPositionSummary()...", "info");
          const summary =
            await window.HyperSolidSDK.position.getPositionSummary();
          updateResult("positionResult", summary);
          addLog("Get position summary successful", "success");
        } catch (error) {
          updateResult("positionResult", `Error: ${error.message}`, true);
          addLog(`Get position summary failed: ${error.message}`, "error");
        }
      }

      async function testHasPosition() {
        try {
          const coin = document.getElementById("positionCoin").value;
          addLog(`Calling position.hasPosition('${coin}')...`, "info");
          const { data: hasPosition } =
            await window.HyperSolidSDK.position.hasPosition(coin);
          updateResult(
            "positionResult",
            `${coin} position status: ${
              hasPosition ? "Has position" : "No position"
            }`
          );
          addLog(
            `${coin} position status: ${
              hasPosition ? "Has position" : "No position"
            }`,
            "info"
          );
        } catch (error) {
          updateResult("positionResult", `Error: ${error.message}`, true);
          addLog(`Check position failed: ${error.message}`, "error");
        }
      }

      async function testGetLongPositions() {
        try {
          addLog("Calling position.getLongPositions()...", "info");
          const positions =
            await window.HyperSolidSDK.position.getLongPositions();
          updateResult("positionResult", positions);
          addLog(`Got ${positions.length} long positions`, "success");
        } catch (error) {
          updateResult("positionResult", `Error: ${error.message}`, true);
          addLog(`Get long positions failed: ${error.message}`, "error");
        }
      }

      async function testGetShortPositions() {
        try {
          addLog("Calling position.getShortPositions()...", "info");
          const positions =
            await window.HyperSolidSDK.position.getShortPositions();
          updateResult("positionResult", positions);
          addLog(`Got ${positions.length} short positions`, "success");
        } catch (error) {
          updateResult("positionResult", `Error: ${error.message}`, true);
          addLog(`Get short positions failed: ${error.message}`, "error");
        }
      }

      // Fill History API Tests
      async function testGetUserFills() {
        try {
          addLog("Calling fills.getUserFills()...", "info");
          const { data: fills } =
            await window.HyperSolidSDK.fills.getUserFills();
          updateResult("fillResult", fills);
          addLog(`Got ${fills.length} fill records`, "success");
        } catch (error) {
          updateResult("fillResult", `Error: ${error.message}`, true);
          addLog(`Get fill history failed: ${error.message}`, "error");
        }
      }

      async function testGetUserFillsByCoin() {
        try {
          const coin = document.getElementById("fillCoin").value;
          if (!coin) {
            addLog("Please enter coin symbol", "error");
            return;
          }
          addLog(`Calling fills.getUserFillsByCoin('${coin}')...`, "info");
          const { data: fills } =
            await window.HyperSolidSDK.fills.getUserFillsByCoin(coin);
          updateResult("fillResult", fills);
          addLog(`Got ${fills.length} ${coin} fill records`, "success");
        } catch (error) {
          updateResult("fillResult", `Error: ${error.message}`, true);
          addLog(`Get coin fill history failed: ${error.message}`, "error");
        }
      }

      async function testGetFillsSummary() {
        try {
          addLog("Calling fills.getFillsSummary()...", "info");
          const { data: summary } =
            await window.HyperSolidSDK.fills.getFillsSummary();
          updateResult("fillResult", summary);
          addLog("Get fill history summary successful", "success");
        } catch (error) {
          updateResult("fillResult", `Error: ${error.message}`, true);
          addLog(`Get fill history summary failed: ${error.message}`, "error");
        }
      }

      // Order API Tests
      async function testGetOpenOrders() {
        try {
          addLog("Calling orders.getOpenOrders()...", "info");
          const { data: orders } =
            await window.HyperSolidSDK.orders.getOpenOrders();
          updateResult("orderResult", orders);
          addLog(`Got ${orders.length} open orders`, "success");
        } catch (error) {
          updateResult("orderResult", `Error: ${error.message}`, true);
          addLog(`Get open orders failed: ${error.message}`, "error");
        }
      }

      async function testGetOpenOrdersByCoin() {
        try {
          const coin = document.getElementById("orderCoin").value;
          addLog(`Calling orders.getOpenOrdersByCoin('${coin}')...`, "info");
          const { data: orders } =
            await window.HyperSolidSDK.orders.getOpenOrdersByCoin(coin);
          updateResult("orderResult", orders);
          addLog(`Got ${orders.length} ${coin} open orders`, "success");
        } catch (error) {
          updateResult("orderResult", `Error: ${error.message}`, true);
          addLog(`Get coin orders failed: ${error.message}`, "error");
        }
      }

      async function testGetOrdersSummary() {
        try {
          addLog("Calling orders.getOrdersSummary()...", "info");
          const summary = await window.HyperSolidSDK.orders.getOrdersSummary();
          updateResult("orderResult", summary);
          addLog("Get order statistics successful", "success");
        } catch (error) {
          updateResult("orderResult", `Error: ${error.message}`, true);
          addLog(`Get order statistics failed: ${error.message}`, "error");
        }
      }

      async function testGetBuyOrders() {
        try {
          addLog("Calling orders.getBuyOrders()...", "info");
          const orders = await window.HyperSolidSDK.orders.getBuyOrders();
          updateResult("orderResult", orders);
          addLog(`Got ${orders.length} buy orders`, "success");
        } catch (error) {
          updateResult("orderResult", `Error: ${error.message}`, true);
          addLog(`Get buy orders failed: ${error.message}`, "error");
        }
      }

      async function testGetSellOrders() {
        try {
          addLog("Calling orders.getSellOrders()...", "info");
          const orders = await window.HyperSolidSDK.orders.getSellOrders();
          updateResult("orderResult", orders);
          addLog(`Got ${orders.length} sell orders`, "success");
        } catch (error) {
          updateResult("orderResult", `Error: ${error.message}`, true);
          addLog(`Get sell orders failed: ${error.message}`, "error");
        }
      }

      // Price Query API Tests
      async function testGetCurrentPrice() {
        try {
          const symbol = document.getElementById("priceSymbol").value;
          const type = document.getElementById("priceType").value;
          if (!symbol) {
            addLog("Please enter trading pair symbol", "error");
            return;
          }
          addLog(
            `Calling price.getCurrentPrice('${symbol}', '${type}')...`,
            "info"
          );
          const { data: priceInfo } =
            await window.HyperSolidSDK.price.getCurrentPrice(symbol, type);
          updateResult("priceResult", priceInfo);
          addLog(`Get ${symbol} current price: $${priceInfo.price}`, "success");
        } catch (error) {
          updateResult("priceResult", `Error: ${error.message}`, true);
          addLog(`Get current price failed: ${error.message}`, "error");
        }
      }

      async function testGetTradeDetail() {
        try {
          const symbol = document.getElementById("priceSymbol").value;
          const type = document.getElementById("priceType").value;
          if (!symbol) {
            addLog("Please enter trading pair symbol", "error");
            return;
          }
          addLog(
            `Calling price.getTradeDetail('${symbol}', '${type}')...`,
            "info"
          );
          const result = await window.HyperSolidSDK.price.getTradeDetail(
            symbol,
            type
          );
          updateResult("priceResult", result || "none");
          addLog(`Get ${symbol} trade details successful`, "success");
        } catch (error) {
          updateResult("priceResult", `Error: ${error.message}`, true);
          addLog(`Get trade details failed: ${error.message}`, "error");
        }
      }

      // Trading API Tests
      async function testLimitBuy() {
        try {
          const symbol = document.getElementById("orderSymbol").value;
          const price = parseFloat(document.getElementById("orderPrice").value);
          const size = parseFloat(document.getElementById("orderSize").value);
          const isSpot = document.getElementById("orderIsSpot").checked;
          const reduceOnly = document.getElementById("orderReduceOnly").checked;

          if (!symbol || !price || !size) {
            addLog("Please fill in complete order parameters", "error");
            return;
          }

          addLog(`Limit buy: ${symbol} price:${price} size:${size}`, "info");
          const { data: result } = await window.HyperSolidSDK.trading.limitBuy({
            symbol,
            price,
            size,
            isSpot,
            reduceOnly,
          });
          updateResult("tradingResult", result);
          addLog(
            `Limit buy successful: ${result.message || "Order submitted"}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Limit buy failed: ${error.message}`, "error");
        }
      }

      async function testLimitSell() {
        try {
          const symbol = document.getElementById("orderSymbol").value;
          const price = parseFloat(document.getElementById("orderPrice").value);
          const size = parseFloat(document.getElementById("orderSize").value);
          const isSpot = document.getElementById("orderIsSpot").checked;
          const reduceOnly = document.getElementById("orderReduceOnly").checked;

          if (!symbol || !price || !size) {
            addLog("Please fill in complete order parameters", "error");
            return;
          }

          addLog(`Limit sell: ${symbol} price:${price} size:${size}`, "info");
          const { data: result } = await window.HyperSolidSDK.trading.limitSell(
            {
              symbol,
              price,
              size,
              isSpot,
              reduceOnly,
            }
          );
          updateResult("tradingResult", result);
          addLog(
            `Limit sell successful: ${result.message || "Order submitted"}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Limit sell failed: ${error.message}`, "error");
        }
      }

      async function testMarketBuy() {
        try {
          const symbol = document.getElementById("orderSymbol").value;
          const size = parseFloat(document.getElementById("orderSize").value);
          const isSpot = document.getElementById("orderIsSpot").checked;
          const reduceOnly = document.getElementById("orderReduceOnly").checked;

          if (!symbol || !size) {
            addLog("Please fill in trading pair symbol and quantity", "error");
            return;
          }

          addLog(`Market buy: ${symbol} size:${size}`, "info");
          const { data: result } = await window.HyperSolidSDK.trading.marketBuy(
            {
              symbol,
              size,
              isSpot,
              reduceOnly,
            }
          );
          updateResult("tradingResult", result);
          addLog(
            `Market buy successful: ${result.message || "Order submitted"}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Market buy failed: ${error.message}`, "error");
        }
      }

      async function testMarketSell() {
        try {
          const symbol = document.getElementById("orderSymbol").value;
          const size = parseFloat(document.getElementById("orderSize").value);
          const isSpot = document.getElementById("orderIsSpot").checked;
          const reduceOnly = document.getElementById("orderReduceOnly").checked;

          if (!symbol || !size) {
            addLog("Please fill in trading pair symbol and quantity", "error");
            return;
          }

          addLog(`Market sell: ${symbol} size:${size}`, "info");
          const { data: result } =
            await window.HyperSolidSDK.trading.marketSell({
              symbol,
              size,
              isSpot,
              reduceOnly,
            });
          updateResult("tradingResult", result);
          addLog(
            `Market sell successful: ${result.message || "Order submitted"}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Market sell failed: ${error.message}`, "error");
        }
      }

      // Percentage Order Helper Functions
      function updatePercentageDisplay() {
        const slider = document.getElementById("percentageSlider");
        const input = document.getElementById("percentageInput");
        input.value = slider.value;
      }

      function updatePercentageSlider() {
        const slider = document.getElementById("percentageSlider");
        const input = document.getElementById("percentageInput");
        slider.value = input.value;
      }

      // Percentage Order Test Functions
      async function testLimitBuyByPercentage() {
        try {
          const symbol = document.getElementById("percentOrderSymbol").value;
          const price = parseFloat(
            document.getElementById("percentOrderPrice").value
          );
          const percentage =
            parseFloat(document.getElementById("percentageInput").value) / 100;
          const isSpot = document.getElementById("percentOrderIsSpot").checked;
          const reduceOnly = document.getElementById(
            "percentOrderReduceOnly"
          ).checked;

          if (!symbol || !price || !percentage) {
            addLog(
              "Please fill in trading pair, price and percentage",
              "error"
            );
            return;
          }

          addLog(
            `Percentage limit buy: ${symbol} price:${price} percentage:${(
              percentage * 100
            ).toFixed(0)}%`,
            "info"
          );
          const { data: result } =
            await window.HyperSolidSDK.trading.limitBuyByPercentage({
              symbol,
              price,
              percentage,
              isSpot,
              reduceOnly,
            });
          updateResult("tradingResult", result);
          addLog(
            `Percentage limit buy successful: actual size ${result.actualSize}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Percentage limit buy failed: ${error.message}`, "error");
        }
      }

      async function testLimitSellByPercentage() {
        try {
          const symbol = document.getElementById("percentOrderSymbol").value;
          const price = parseFloat(
            document.getElementById("percentOrderPrice").value
          );
          const percentage =
            parseFloat(document.getElementById("percentageInput").value) / 100;
          const isSpot = document.getElementById("percentOrderIsSpot").checked;
          const reduceOnly = document.getElementById(
            "percentOrderReduceOnly"
          ).checked;

          if (!symbol || !price || !percentage) {
            addLog(
              "Please fill in trading pair, price and percentage",
              "error"
            );
            return;
          }

          addLog(
            `Percentage limit sell: ${symbol} price:${price} percentage:${(
              percentage * 100
            ).toFixed(0)}%`,
            "info"
          );
          const { data: result } =
            await window.HyperSolidSDK.trading.limitSellByPercentage({
              symbol,
              price,
              percentage,
              isSpot,
              reduceOnly,
            });
          updateResult("tradingResult", result);
          addLog(
            `Percentage limit sell successful: actual size ${result.actualSize}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Percentage limit sell failed: ${error.message}`, "error");
        }
      }

      async function testMarketBuyByPercentage() {
        try {
          const symbol = document.getElementById("percentOrderSymbol").value;
          const percentage =
            parseFloat(document.getElementById("percentageInput").value) / 100;
          const isSpot = document.getElementById("percentOrderIsSpot").checked;
          const reduceOnly = document.getElementById(
            "percentOrderReduceOnly"
          ).checked;

          if (!symbol || !percentage) {
            addLog("Please fill in trading pair and percentage", "error");
            return;
          }

          addLog(
            `Percentage market buy: ${symbol} percentage:${(
              percentage * 100
            ).toFixed(0)}%`,
            "info"
          );
          const { data: result } =
            await window.HyperSolidSDK.trading.marketBuyByPercentage({
              symbol,
              percentage,
              isSpot,
              reduceOnly,
            });
          updateResult("tradingResult", result);
          addLog(
            `Percentage market buy successful: actual size ${result.actualSize} @ ${result.price}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Percentage market buy failed: ${error.message}`, "error");
        }
      }

      async function testMarketSellByPercentage() {
        try {
          const symbol = document.getElementById("percentOrderSymbol").value;
          const percentage =
            parseFloat(document.getElementById("percentageInput").value) / 100;
          const isSpot = document.getElementById("percentOrderIsSpot").checked;
          const reduceOnly = document.getElementById(
            "percentOrderReduceOnly"
          ).checked;

          if (!symbol || !percentage) {
            addLog("Please fill in trading pair and percentage", "error");
            return;
          }

          addLog(
            `Percentage market sell: ${symbol} percentage:${(
              percentage * 100
            ).toFixed(0)}%`,
            "info"
          );
          const { data: result } =
            await window.HyperSolidSDK.trading.marketSellByPercentage({
              symbol,
              percentage,
              isSpot,
              reduceOnly,
            });
          updateResult("tradingResult", result);
          addLog(
            `Percentage market sell successful: actual size ${result.actualSize} @ ${result.price}`,
            "success"
          );
        } catch (error) {
          updateResult("tradingResult", `Error: ${error.message}`, true);
          addLog(`Percentage market sell failed: ${error.message}`, "error");
        }
      }

      // User Asset Information API Tests
      async function testGetUserActiveAssetData() {
        try {
          const symbol = document.getElementById("assetSymbol").value;
          addLog(
            `Calling asset.getUserActiveAssetData('${symbol}')...`,
            "info"
          );
          const { data: data } =
            await window.HyperSolidSDK.asset.getUserActiveAssetData(symbol);
          updateResult("assetResult", data);
          addLog(`Get user asset data successful: ${symbol}`, "success");
        } catch (error) {
          updateResult("assetResult", `Error: ${error.message}`, true);
          addLog(`Get user asset data failed: ${error.message}`, "error");
        }
      }

      async function testGetUserMaxTradeSizes() {
        try {
          const symbol = document.getElementById("assetSymbol").value;
          addLog(`Calling asset.getUserMaxTradeSizes('${symbol}')...`, "info");
          const { data: data } =
            await window.HyperSolidSDK.asset.getUserMaxTradeSizes(symbol);
          updateResult("assetResult", data);
          addLog(`Get user trade volume successful: ${symbol}`, "success");
        } catch (error) {
          updateResult("assetResult", `Error: ${error.message}`, true);
          addLog(`Get user trade volume failed: ${error.message}`, "error");
        }
      }

      // Navigation API Tests
      async function testNavigateHome() {
        try {
          addLog("Calling navigation.toHome()...", "info");
          const { data: result } =
            await window.HyperSolidSDK.navigation.toHome();
          updateResult(
            "navigationResult",
            `Navigate to home: ${result ? "Success" : "Failed"}`
          );
          addLog(
            `Navigate to home: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testNavigatePortfolio() {
        try {
          addLog("Calling navigation.toPortfolio()...", "info");
          const { data: result } =
            await window.HyperSolidSDK.navigation.toPortfolio();
          updateResult(
            "navigationResult",
            `Navigate to portfolio: ${result ? "Success" : "Failed"}`
          );
          addLog(
            `Navigate to portfolio: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testNavigateTrade() {
        try {
          addLog("Calling navigation.toTrade()...", "info");
          const { data: result } =
            await window.HyperSolidSDK.navigation.toTrade();
          updateResult(
            "navigationResult",
            `Navigate to trade page: ${result ? "Success" : "Failed"}`
          );
          addLog(
            `Navigate to trade page: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testNavigateAccount() {
        try {
          addLog("Calling navigation.toAccount()...", "info");
          const { data: result } =
            await window.HyperSolidSDK.navigation.toAccount();
          updateResult(
            "navigationResult",
            `Navigate to account page: ${result ? "Success" : "Failed"}`
          );
          addLog(
            `Navigate to account page: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testNavigateTradeDetail() {
        try {
          const symbol = document.getElementById("tradeSymbol").value;
          const type = document.getElementById("tradeType").value;

          addLog(
            `Calling navigation.toTradeDetail({symbol: '${symbol}', type: '${type}'})...`,
            "info"
          );
          const { data: result } =
            await window.HyperSolidSDK.navigation.toTradeDetail({
              symbol: symbol,
              type: type,
            });
          updateResult(
            "navigationResult",
            `Navigate to trade detail (${symbol}, ${type}): ${
              result ? "Success" : "Failed"
            }`
          );
          addLog(
            `Navigate to trade detail: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testNavigateTradeOrder() {
        try {
          const symbol = document.getElementById("tradeSymbol").value;
          const type = document.getElementById("tradeType").value;

          addLog(
            `Calling navigation.toTradeOrder({symbol: '${symbol}', type: '${type}'})...`,
            "info"
          );
          const { data: result } =
            await window.HyperSolidSDK.navigation.toTradeOrder({
              symbol: symbol,
              type: type,
              action: "buy",
            });
          updateResult(
            "navigationResult",
            `Navigate to trade order (${symbol}, ${type}): ${
              result ? "Success" : "Failed"
            }`
          );
          addLog(
            `Navigate to trade order: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testNavigateCustom() {
        try {
          const route = document.getElementById("customRoute").value;

          addLog(`Calling navigation.navigateTo('${route}')...`, "info");
          const { data: result } =
            await window.HyperSolidSDK.navigation.navigateTo(route);
          updateResult(
            "navigationResult",
            `Navigate to ${route}: ${result ? "Success" : "Failed"}`
          );
          addLog(
            `Navigate to ${route}: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Navigation failed: ${error.message}`, "error");
        }
      }

      async function testGoBack() {
        try {
          addLog("Calling navigation.goBack()...", "info");
          const { data: result } =
            await window.HyperSolidSDK.navigation.goBack();
          updateResult(
            "navigationResult",
            `Go back: ${result ? "Success" : "Failed"}`
          );
          addLog(
            `Go back: ${result ? "Success" : "Failed"}`,
            result ? "success" : "error"
          );
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Go back failed: ${error.message}`, "error");
        }
      }

      async function testCanGoBack() {
        try {
          addLog("Calling navigation.canGoBack()...", "info");
          const { data: canGoBack } =
            await window.HyperSolidSDK.navigation.canGoBack();
          updateResult(
            "navigationResult",
            `Can go back: ${canGoBack ? "Yes" : "No"}`
          );
          addLog(`Can go back: ${canGoBack ? "Yes" : "No"}`, "info");
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Check failed: ${error.message}`, "error");
        }
      }

      async function testGetCurrentRoute() {
        try {
          addLog("Calling navigation.getCurrentRoute()...", "info");
          const { data: route } =
            await window.HyperSolidSDK.navigation.getCurrentRoute();
          updateResult("navigationResult", `Current route: ${route}`);
          addLog(`Current route: ${route}`, "info");
        } catch (error) {
          updateResult("navigationResult", `Error: ${error.message}`, true);
          addLog(`Get route failed: ${error.message}`, "error");
        }
      }

      // System API Tests
      function testRefresh() {
        addLog("Calling system.refresh()...", "info");
        window.HyperSolidSDK.system.refresh();
        updateResult("systemResult", "Page refreshing...");
      }

      function testGetVersion() {
        addLog("Calling system.getVersion()...", "info");
        const version = window.HyperSolidSDK.system.getVersion();
        updateResult("systemResult", `SDK Version: ${version}`);
        addLog(`SDK Version: ${version}`, "success");
      }

      async function testPing() {
        try {
          addLog("Calling system.ping()...", "info");
          const { data: result } = await window.HyperSolidSDK.system.ping();
          updateResult("systemResult", result || "Pong!");
          addLog("Ping successful", "success");
        } catch (error) {
          updateResult("systemResult", `Error: ${error.message}`, true);
          addLog(`Ping failed: ${error.message}`, "error");
        }
      }

      async function testGetSystemInfo() {
        try {
          addLog("Calling system.getSystemInfo()...", "info");
          const { data: info } =
            await window.HyperSolidSDK.system.getSystemInfo();
          updateResult("systemResult", info);
          addLog("Get system info successful", "success");
        } catch (error) {
          updateResult("systemResult", `Error: ${error.message}`, true);
          addLog(`Get system info failed: ${error.message}`, "error");
        }
      }

      // Page Load Initialization
      window.addEventListener("load", function () {
        // Check SDK Status
        if (checkSDKStatus()) {
          addLog("Page loaded, SDK ready", "success");
        } else {
          // Register SDK Ready Callback
          if (window.HyperSolidSDK && window.HyperSolidSDK.utils) {
            window.HyperSolidSDK.utils.onReady(function () {
              checkSDKStatus();
            });
          } else {
            addLog(
              "HyperSolid SDK not found, please check include path",
              "error"
            );
            document.getElementById("statusText").textContent =
              "SDK load failed";
          }
        }

        // Periodic SDK Status Check (Fallback)
        const checkInterval = setInterval(function () {
          if (checkSDKStatus()) {
            clearInterval(checkInterval);
          }
        }, 1000);

        // Stop checking after 5 seconds
        setTimeout(function () {
          clearInterval(checkInterval);
          if (!window.HyperSolidSDK || !window.HyperSolidSDK.utils.isReady()) {
            addLog("SDK initialization timeout", "error");
            document.getElementById("statusText").textContent =
              "SDK initialization timeout";
          }
        }, 5000);
      });

      // Listen to Console Logs
      const originalLog = console.log;
      const originalError = console.error;
      const originalWarn = console.warn;

      console.log = function (...args) {
        originalLog.apply(console, args);
        addLog(args.join(" "), "info");
      };

      console.error = function (...args) {
        originalError.apply(console, args);
        addLog(args.join(" "), "error");
      };

      console.warn = function (...args) {
        originalWarn.apply(console, args);
        addLog(args.join(" "), "info");
      };
    </script>
  </body>
</html>
